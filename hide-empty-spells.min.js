const debugHE=!0;let hideEmpty=!1;function log(message,level=0){let color1,color2;2==level?(color1="color: #7bf542",color2="color: #801008",debugHE&&console.log("%cHide Empty Spells | %c ",color1,color2,message)):1==level?(color1="color: #7bf542",color2="color: #085e80",debugHE&&console.log("%cHide Empty Spells | %c ",color1,color2,message)):(color1="color: #7bf542",color2="color: #cccccc",console.log("%cHide Empty Spells | %c ",color1,color2,message))}function addButton(html,hide=1){hidetitle="Hide Empty Spell Casting Entries",hidefa="eye-slash",showtitle="Show Empty Spell Casting Entries",showfa="eye";$(html).attr("id");var newButton=html.find("[data-tab='spellbook']"),button=$(newButton).find("ol.spellcastingEntry-list.directory-list.item-list"),newButton='<li class="item inventory-header spellbook-header spellbook-empty" id="showspells" draggable="true"><div class="item-controls pf-bluelist pf-add-item-row"><a class="item-control spellcasting-create" title="'+hidetitle+'" ><i class="fas fa-'+hidefa+'"></i>'+hidetitle+"</a></div></li>";$(button).append(newButton),newButton='<li class="item inventory-header spellbook-header spellbook-empty" id="hidespells" draggable="true"><div class="item-controls pf-bluelist pf-add-item-row"><a class="item-control spellcasting-create" title="'+showtitle+'" ><i class="fas fa-'+showfa+'"></i>'+showtitle+"</a></div></li>",$(button).append(newButton),(1==hide?html.find("#showspells"):html.find("#hidespells")).hide(),$("#hidespells").on("click",function(){game.settings.set("hide-empty-spells","hideEmpty",!1),html.find("#hidespells").hide(),html.find("#showspells").show(),showEmptySpells(html)}),$("#showspells").on("click",function(){game.settings.set("hide-empty-spells","hideEmpty",!0),html.find("#hidespells").show(),html.find("#showspells").hide(),hideEmptySpells(html)})}function hideEmptySpells(html){let spellsPage=html.find("[data-tab='spellbook']");var spellContainers=spellsPage.find('[data-container-type="spellcastingEntry"]');for(let x=0;x<spellContainers.length;x++){var spellBox=spellContainers[x];log(spellBox,2);var spellcastingEntry=$(spellBox).find("ol.directory-list.item-list.spell-list");log(spellcastingEntry,2);for(let y=0;y<spellcastingEntry.length;y++){var spellLevel=$(spellcastingEntry).find("li.item.inventory-header.spellbook-header");log(spellLevel,2);for(let z=0;z<spellLevel.length;z++)"0"==$(spellLevel[z]).find("span.spell-max-input input").val()&&(log(spellLevel[z],2),$(spellLevel[z]).hide(),$(spellLevel[z]).nextUntil("item.inventory-header.spellbook-header").hide())}}}function showEmptySpells(html){let spellsPage=html.find("[data-tab='spellbook']");var spellContainers=spellsPage.find('[data-container-type="spellcastingEntry"]');for(let x=0;x<spellContainers.length;x++){var spellBox=spellContainers[x],spellcastingEntry=$(spellBox).find("ol.directory-list.item-list.spell-list");for(let y=0;y<spellcastingEntry.length;y++){var spellLevel=$(spellcastingEntry).find("li.item.inventory-header.spellbook-header");for(let z=0;z<spellLevel.length;z++){$(spellLevel[z]).find("span.spell-max-input input").val();$(spellLevel[z]).show(),$(spellLevel[z]).nextUntil("item.inventory-header.spellbook-header").show()}}}}Hooks.on("ready",async function(){game.settings.register("hide-empty-spells","hideEmpty",{name:"hideempty",scope:"client",config:!1,type:String,default:"false"})}),Hooks.on("renderActorSheet",function(obj,html){"character"===obj.actor.data.type&&(hideEmpty=game.settings.get("hide-empty-spells","hideEmpty"),log("hideEmpty: "+hideEmpty,2),"true"==hideEmpty?(log("hiding all",2),addButton(html),hideEmptySpells(html)):(log("showing all"),addButton(html,0),showEmptySpells(html)))});